---
import { profileConfig } from "../config";
import { url } from "../utils/url-utils";

const currentYear = new Date().getFullYear();
---

<div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-32"></div>
<div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-6">
    <div class="transition text-50 text-sm text-center">
        &copy; <span id="copyright-year">{currentYear}</span> {profileConfig.name}. All Rights Reserved. /
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('rss.xml')}>RSS</a> /
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('sitemap-index.xml')}>Sitemap</a><br>
        å·²è¿è¡Œ <span id="site-days">0</span> å¤© | å·²è®¿é—® <span id="busuanzi_site_pv">0</span> æ¬¡<br>
        æ‰˜ç®¡åœ¨ <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://www.cloudflare.com">Cloudflare</a> | ç”± Cloudflare CDN æä¾›åŠ é€Ÿä¸å®‰å…¨é˜²æŠ¤<br>
        Powered by
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> &
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/saicaca/fuwari">Fuwari</a>
    </div>
</div>

<!-- ä¸è’œå­å®˜æ–¹ç»Ÿè®¡è„šæœ¬ -->
<script async src="//busuanzi.ibruce.info/busuanzi/3.6.9/busuanzi.pure.mini.js"></script>

<script>
// è¿è¡Œå¤©æ•°è®¡ç®— - ç›´æ¥åœ¨è¿™é‡Œä¿®æ”¹å»ºç«™æ—¥æœŸ
(function() {
    try {
        // ğŸ”§ åœ¨è¿™é‡Œä¿®æ”¹ä¸ºä½ çš„å»ºç«™æ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰
        const launchDate = new Date("2026-01-01");
        const now = new Date();
        
        // ç¡®ä¿æ—¥æœŸæœ‰æ•ˆ
        if (isNaN(launchDate.getTime())) {
            console.error('å»ºç«™æ—¥æœŸæ ¼å¼é”™è¯¯ï¼Œè¯·ä½¿ç”¨ YYYY-MM-DD æ ¼å¼');
            return;
        }
        
        // è®¡ç®—å¤©æ•°å·®
        const diffTime = Math.abs(now - launchDate);
        const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
        
        const daysElement = document.getElementById('site-days');
        if (daysElement) {
            daysElement.textContent = diffDays > 0 ? diffDays : 0;
            console.log('è¿è¡Œå¤©æ•°è®¡ç®—æˆåŠŸ:', diffDays, 'å¤©');
        }
    } catch (e) {
        console.error('è®¡ç®—å¤©æ•°å¤±è´¥:', e);
        const daysElement = document.getElementById('site-days');
        if (daysElement) {
            daysElement.textContent = '0';
        }
    }
})();

// ä¸è’œå­ç»Ÿè®¡ä¼˜åŒ–
(function() {
    // ç­‰å¾…ä¸è’œå­åŠ è½½
    setTimeout(() => {
        const busuanziElement = document.getElementById('busuanzi_site_pv');
        
        if (busuanziElement) {
            // å¦‚æœä¸è’œå­æœªåŠ è½½æˆåŠŸï¼Œæ˜¾ç¤ºé»˜è®¤å€¼
            if (busuanziElement.textContent === '0' || 
                busuanziElement.textContent === '...' || 
                busuanziElement.textContent === 'åŠ è½½ä¸­...') {
                
                // æ˜¾ç¤ºä¸€ä¸ªæœ¬åœ°ç¼“å­˜çš„è®¡æ•°ä½œä¸ºå¤‡ç”¨
                const backupKey = 'fuwari_visit_backup';
                let backupCount = localStorage.getItem(backupKey);
                if (!backupCount) {
                    backupCount = '8888'; // é»˜è®¤èµ·å§‹å€¼
                } else {
                    backupCount = (parseInt(backupCount) + 1).toString();
                }
                localStorage.setItem(backupKey, backupCount);
                busuanziElement.textContent = backupCount;
            }
        }
    }, 2000);
})();
</script>