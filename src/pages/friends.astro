---
import { siteConfig } from "@/config";
import type { Friend } from "@/types/data";
import MainGridLayout from "@layouts/MainGridLayout.astro";
import { Icon } from "astro-icon/components";

const friends = Object.values(
	import.meta.glob<Friend>("@/data/friends/*.json", {
		eager: true,
		import: "default",
	}),
);

// æŠŠå‹é“¾ä¿¡æ¯å®šä¹‰åœ¨è„šæœ¬åŒºï¼ˆ--- å†…ï¼‰ï¼Œé¿å…æ¨¡æ¿è§£æå†²çª
const friendInfoExample = {
    "name": "Qgxs&Blog",
    "avatar": "https://s41.ax1x.com/2026/01/31/pZhVLLD.jpg",
    "description": "æ”¾æ¾å¿ƒæƒ…ï¼Œæ¼«æ¸¸å››å¤„ï¼Œå¤„å¤„ç¾æ™¯ã€‚",
    "url": "https://blog.20210701.xyz/"
};
---

<MainGridLayout title="å‹é“¾">
    <div class="card-base p-6 md:p-8">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <div class="flex items-center gap-2 mb-6">
            <div class="h-8 w-8 rounded-lg bg-[var(--primary)] flex items-center justify-center text-white dark:text-black/70">
                <Icon name="material-symbols:diversity-3" class="text-[1.5rem]" />
            </div>
            <h1 class="text-2xl font-bold text-black dark:text-white">å‹é“¾</h1>
        </div>

        <!-- ç”³è¯·å‹é“¾è¯´æ˜ -->
        <div class="mb-8 p-4 rounded-xl bg-gradient-to-br from-pink-50/80 to-rose-50/60 dark:from-pink-900/20 dark:to-rose-900/15 border border-pink-100/50 dark:border-pink-800/30 shadow-sm">
            <h2 class="text-lg font-semibold text-black dark:text-white mb-2 flex items-center gap-2">
                <Icon name="material-symbols:mail-outline" class="text-[1.2rem] text-pink-600 dark:text-pink-400" />
                <span class="bg-gradient-to-r from-pink-600 to-rose-600 dark:from-pink-400 dark:to-rose-400 bg-clip-text text-transparent">
                    ç”³è¯·å‹é“¾
                </span>
            </h2>
            <p class="text-sm text-black/70 dark:text-white/70 mb-3">
                å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥å‹é“¾åå•ï¼Œè¯·ç»™æˆ‘å‘é€é‚®ä»¶ï¼
            </p>
            <div class="flex flex-wrap gap-2 mb-3">
                <div class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-900/30 text-pink-700 dark:text-pink-300 rounded-full cursor-pointer hover:bg-pink-200 dark:hover:bg-pink-800/40 transition-colors select-all" onclick="copyEmail('crqgxs@qq.com')">
                    ğŸ“§ crqgxs@qq.com
                </div>
                <div class="text-xs px-3 py-1 bg-pink-100 dark:bg-pink-900/30 text-pink-700 dark:text-pink-300 rounded-full cursor-pointer hover:bg-pink-200 dark:hover:bg-pink-800/40 transition-colors select-all" onclick="copyEmail('1044192982@qq.com')">
                    ğŸ“§ 1044192982@qq.com
                </div>
            </div>
            <p class="text-sm text-black/70 dark:text-white/70 mb-2">
                é‚®ä»¶ä¸­è¯·åŒ…å«ä»¥ä¸‹å‹é“¾ä¿¡æ¯æ ¼å¼ï¼ˆè¯·å‚è€ƒæˆ‘çš„ä¿¡æ¯ï¼‰ï¼š
            </p>
            
            <!-- å¯å¤åˆ¶çš„ä»£ç å— -->
            <div class="relative">
                <pre class="text-xs bg-white/80 dark:bg-gray-800/60 p-4 rounded-lg overflow-x-auto border border-pink-200/50 dark:border-pink-800/40 font-mono cursor-pointer select-all" onclick="copyExampleCode()">
{JSON.stringify(friendInfoExample, null, 4)}
                </pre>
                <div class="absolute top-2 right-2 px-2 py-1 text-xs bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm rounded border border-pink-200 dark:border-pink-800 text-pink-600 dark:text-pink-400 transition-colors shadow-sm pointer-events-none">
                    ç‚¹å‡»å¤åˆ¶
                </div>
            </div>
        </div>

        <!-- å‹æƒ…é“¾æ¥åˆ—è¡¨æ ‡é¢˜ -->
        <div class="mb-6">
            <div class="flex items-center gap-2 mb-3">
                <Icon name="material-symbols:favorite" class="text-[1.5rem] text-pink-500 dark:text-pink-400" />
                <h2 class="text-xl font-bold text-black dark:text-white">å‹æƒ…é“¾æ¥åˆ—è¡¨</h2>
            </div>
            <p class="text-sm text-black/60 dark:text-white/60">
                æ„Ÿè°¢ä»¥ä¸‹æœ‹å‹ä¸ºæœ¬ç«™æä¾›çš„æ”¯æŒä¸å¸®åŠ©ï¼Œæ’åä¸åˆ†å…ˆå
            </p>
        </div>

        <!-- å‹é“¾å±•ç¤º -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {friends.map((friend) => (
                <a href={friend.url} target="_blank" class="friend-card group">
                    <div class="flex items-center gap-3">
                        <div class="relative w-10 h-10 rounded-full overflow-hidden ring-2 ring-white dark:ring-gray-800 shadow-sm" style={`--theme-hue: ${siteConfig.themeColor.hue}`}>
                            <img src={friend.avatar} loading="lazy" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110" alt={`${friend.name}çš„å¤´åƒ`} />
                        </div>
                        <div class="min-w-0 flex-1">
                            <div class="font-bold text-black dark:text-white group-hover:text-pink-600 dark:group-hover:text-pink-400 transition-colors truncate">{friend.name}</div>
                        </div>
                    </div>
                    <div class="text-sm text-black/60 dark:text-white/60 mt-2 ml-12">{friend.description}</div>
                </a>
            ))}
        </div>
    </div>
</MainGridLayout>

<style>
    .friend-card {
        @apply flex flex-col p-4 rounded-xl bg-gradient-to-br from-white/60 to-white/40 dark:from-gray-800/30 dark:to-gray-800/10 border border-black/5 dark:border-white/10 transition-all duration-300;
        backdrop-filter: blur(8px);
        transform: translateZ(0);
    }
    
    .friend-card:hover {
        border-color: rgba(236, 72, 153, 0.3);
        background: linear-gradient(135deg, rgba(236, 72, 153, 0.05) 0%, rgba(236, 72, 153, 0.02) 100%);
        transform: translateY(-2px);
        box-shadow: 0 10px 25px -5px rgba(236, 72, 153, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
    }
    
    .friend-card:active {
        transform: translateY(0);
    }
    
    @media (max-width: 768px) {
        .friend-card {
            @apply p-3;
        }
        .ml-12 {
            margin-left: 0;
            margin-top: 0.75rem;
        }
    }
    
    .select-all {
        user-select: all;
        -webkit-user-select: all;
        -moz-user-select: all;
        -ms-user-select: all;
    }
</style>

<script is:inline>
// å¤åˆ¶é‚®ç®±åœ°å€
function copyEmail(email) {
    navigator.clipboard.writeText(email).then(() => {
        const element = event.target;
        const originalText = element.textContent;
        
        element.textContent = 'âœ… å·²å¤åˆ¶ï¼';
        element.classList.remove('bg-pink-100', 'dark:bg-pink-900/30', 'text-pink-700', 'dark:text-pink-300');
        element.classList.add('bg-green-100', 'dark:bg-green-900/30', 'text-green-700', 'dark:text-green-300');
        
        setTimeout(() => {
            element.textContent = originalText;
            element.classList.remove('bg-green-100', 'dark:bg-green-900/30', 'text-green-700', 'dark:text-green-300');
            element.classList.add('bg-pink-100', 'dark:bg-pink-900/30', 'text-pink-700', 'dark:text-pink-300');
        }, 2000);
    }).catch(err => {
        console.error('å¤åˆ¶å¤±è´¥:', err);
        // ç§»é™¤ alert å¼¹çª—
    });
}

// å¤åˆ¶ç¤ºä¾‹ä»£ç åˆ°å‰ªè´´æ¿
function copyExampleCode() {
    const exampleCode = JSON.stringify({
        "name": "Qgxs&Blog",
        "avatar": "https://s41.ax1x.com/2026/01/31/pZhVLLD.jpg",
        "description": "æ”¾æ¾å¿ƒæƒ…ï¼Œæ¼«æ¸¸å››å¤„ï¼Œå¤„å¤„ç¾æ™¯ã€‚",
        "url": "https://blog.20210701.xyz/"
    }, null, 4);
    
    navigator.clipboard.writeText(exampleCode).then(() => {
        const preElement = event.target.closest('pre');
        const buttonElement = preElement.nextElementSibling;
        const originalText = buttonElement.textContent;
        
        buttonElement.textContent = 'âœ… å·²å¤åˆ¶ï¼';
        buttonElement.classList.remove('text-pink-600', 'dark:text-pink-400');
        buttonElement.classList.add('text-green-600', 'dark:text-green-400', 'bg-green-50', 'dark:bg-green-900/20');
        
        setTimeout(() => {
            buttonElement.textContent = originalText;
            buttonElement.classList.remove('text-green-600', 'dark:text-green-400', 'bg-green-50', 'dark:bg-green-900/20');
            buttonElement.classList.add('text-pink-600', 'dark:text-pink-400');
        }, 2000);
    }).catch(err => {
        console.error('å¤åˆ¶å¤±è´¥:', err);
        // ç§»é™¤ alert å¼¹çª—
    });
}
</script>